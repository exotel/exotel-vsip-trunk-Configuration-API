name: CI - Validation

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  validate:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Validate shell scripts
      run: |
        echo "ğŸš Validating shell scripts..."
        find curl/ -name "*.sh" -exec bash -n {} \;
        echo "âœ… Shell scripts are valid"
        
    - name: Validate JSON files
      run: |
        echo "ğŸ“„ Validating JSON files..."
        for file in postman/*.json; do
          python3 -m json.tool "$file" > /dev/null
        done
        echo "âœ… JSON files are valid"
        
    - name: Check for sensitive information
      run: |
        echo "ğŸ” Checking for sensitive information..."
        
        # Check for real trunk SIDs
        if grep -rE "trmum1[a-f0-9]{20,}" --exclude-dir=.git .; then
          echo "âŒ Found potential real trunk SIDs"
          exit 1
        fi
        
        echo "âœ… No sensitive information found"
