{
  "info": {
    "name": "Exotel SIP Trunking APIs",
    "description": "SIP Trunking APIs for connecting your PBX, Contact Center, or Voice AI system to the telephone network.\n\n## Setup\n1. Set collection variables (api_key, api_token, account_sid)\n2. Follow the numbered steps in each folder\n\n## Folders\n- **GETTING STARTED (PSTN)**: Standard telephone network setup\n- **STREAMKIT (Voice AI)**: Voice AI bot integration\n- **MANAGE & VIEW**: View and manage configurations",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "api_key",
      "value": "your_api_key",
      "type": "string"
    },
    {
      "key": "api_token",
      "value": "your_api_token",
      "type": "string"
    },
    {
      "key": "account_sid",
      "value": "your_account_sid",
      "type": "string"
    },
    {
      "key": "subdomain",
      "value": "api.in.exotel.com",
      "type": "string"
    },
    {
      "key": "trunk_sid",
      "value": "your_trunk_sid",
      "type": "string"
    },
    {
      "key": "phone_number_id",
      "value": "12345",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. GETTING STARTED (PSTN)",
      "description": "Standard PSTN setup for making and receiving calls via telephone network.\n\nFollow these steps in order:\n1. Create Trunk\n2. Map Phone Number to Trunk\n3. Map ACL to Trunk (for Outbound)\n4. Map Destination URI to Trunk (for Inbound)",
      "item": [
        {
          "name": "Step 1: Create Trunk",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"trunk_name\": \"my_trunk\",\n  \"nso_code\": \"ANY-ANY\",\n  \"domain_name\": \"{{account_sid}}.pstn.exotel.com\"\n}"
            },
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks"]
            },
            "description": "Creates a new SIP trunk.\n\n**Important:** Save the `trunk_sid` from the response - needed for all subsequent API calls.\n\n**Parameters:**\n- `trunk_name`: Unique name (max 16 chars, alphanumeric + underscore)\n- `nso_code`: Use `ANY-ANY`\n- `domain_name`: Format: `{account_sid}.pstn.exotel.com`"
          }
        },
        {
          "name": "Step 2: Map Phone Number to Trunk",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone_number\": \"+919876543210\"\n}"
            },
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks/{{trunk_sid}}/phone-numbers",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks", "{{trunk_sid}}", "phone-numbers"]
            },
            "description": "Maps a phone number (DID/ExoPhone) to the trunk.\n\n**Important:** Save the `id` from the response - needed for Update Phone Number Mode API.\n\n**Parameters:**\n- `phone_number`: E.164 format (e.g., +919876543210)\n- `mode`: Optional. Use `pstn` (default) or `flow` (for StreamKit)"
          }
        },
        {
          "name": "Step 3: Map ACL to Trunk (Whitelist IP)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ip\": \"YOUR_SERVER_IP\",\n  \"mask\": 32\n}"
            },
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks/{{trunk_sid}}/whitelisted-ips",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks", "{{trunk_sid}}", "whitelisted-ips"]
            },
            "description": "Whitelists your server's public IP for authentication.\n\n**Required for:** Outbound/Termination calls\n\n**Note:** If using IP for destination URI, whitelist it here first!\n\n**Parameters:**\n- `ip`: Your server's public IP address\n- `mask`: Subnet mask (32 = single IP, 24 = /24 subnet)"
          }
        },
        {
          "name": "Step 4: Map Destination URI to Trunk",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"destinations\": [\n    {\n      \"destination\": \"YOUR_SERVER_IP:5061;transport=tls\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks/{{trunk_sid}}/destination-uris",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks", "{{trunk_sid}}", "destination-uris"]
            },
            "description": "Configures where incoming calls are routed.\n\n**Required for:** Inbound/Origination calls\n\n**⚠️ Important:**\n- For IP destinations: Whitelist the IP first (Step 3)\n- For FQDN destinations: No whitelisting needed\n\n**Parameters:**\n- `destination`: Format `<ip_or_fqdn>:<port>;transport=<tls|tcp>`\n\n**Examples:**\n- IP: `44.248.146.11:5061;transport=tls`\n- FQDN: `sip.company.com:5061;transport=tls`"
          }
        }
      ]
    },
    {
      "name": "2. STREAMKIT (Voice AI)",
      "description": "StreamKit setup for connecting to Voice AI bots.\n\nFollow these steps:\n1. Create Trunk (same as PSTN)\n2. Map Phone Number with mode: flow\n3. Map ACL to Trunk",
      "item": [
        {
          "name": "Step 1: Create Trunk",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"trunk_name\": \"streamkit_trunk\",\n  \"nso_code\": \"ANY-ANY\",\n  \"domain_name\": \"{{account_sid}}.pstn.exotel.com\"\n}"
            },
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks"]
            },
            "description": "Creates a new SIP trunk for StreamKit.\n\n**Important:** Save the `trunk_sid` from the response."
          }
        },
        {
          "name": "Step 2: Map Phone Number (Flow Mode)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone_number\": \"+919876543210\",\n  \"mode\": \"flow\"\n}"
            },
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks/{{trunk_sid}}/phone-numbers",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks", "{{trunk_sid}}", "phone-numbers"]
            },
            "description": "Maps a phone number with flow mode for Voice AI routing.\n\n**Important:** `mode: flow` routes calls to Voice AI bot instead of PSTN.\n\n**Parameters:**\n- `phone_number`: E.164 format\n- `mode`: Must be `flow` for StreamKit"
          }
        },
        {
          "name": "Step 3: Map ACL to Trunk",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ip\": \"YOUR_SERVER_IP\",\n  \"mask\": 32\n}"
            },
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks/{{trunk_sid}}/whitelisted-ips",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks", "{{trunk_sid}}", "whitelisted-ips"]
            },
            "description": "Whitelists your server's public IP.\n\n**Parameters:**\n- `ip`: Your server's public IP address\n- `mask`: 32 for single IP"
          }
        }
      ]
    },
    {
      "name": "3. MANAGE & VIEW",
      "description": "APIs for viewing configurations and managing your trunk.",
      "item": [
        {
          "name": "Get Phone Numbers",
          "request": {
            "method": "GET",
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks/{{trunk_sid}}/phone-numbers",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks", "{{trunk_sid}}", "phone-numbers"]
            },
            "description": "Lists all phone numbers mapped to the trunk."
          }
        },
        {
          "name": "Get ACLs (Whitelisted IPs)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks/{{trunk_sid}}/whitelisted-ips",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks", "{{trunk_sid}}", "whitelisted-ips"]
            },
            "description": "Lists all whitelisted IP addresses for the trunk."
          }
        },
        {
          "name": "Get Destination URIs",
          "request": {
            "method": "GET",
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks/{{trunk_sid}}/destination-uris",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks", "{{trunk_sid}}", "destination-uris"]
            },
            "description": "Lists all destination URIs configured for the trunk."
          }
        },
        {
          "name": "Update Phone Number Mode",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone_number\": \"+919876543210\",\n  \"mode\": \"flow\"\n}"
            },
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks/{{trunk_sid}}/phone-numbers/{{phone_number_id}}",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks", "{{trunk_sid}}", "phone-numbers", "{{phone_number_id}}"]
            },
            "description": "Updates the routing mode for a mapped phone number.\n\n**⚠️ Important:** Use the numeric `id` from Map Phone Number response, NOT the phone number!\n\nExample: If response had `\"id\": \"41523\"`, use `41523` in the URL.\n\n**Mode Options:**\n- `pstn`: Route to telephone network\n- `flow`: Route to Voice AI bot (StreamKit)"
          }
        },
        {
          "name": "Set Trunk Alias (Caller ID)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"settings\": [\n    {\n      \"name\": \"trunk_external_alias\",\n      \"value\": \"+919876543210\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks/{{trunk_sid}}/settings",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks", "{{trunk_sid}}", "settings"]
            },
            "description": "Sets the outbound caller ID displayed to called parties.\n\n**Parameters:**\n- `name`: Use `trunk_external_alias`\n- `value`: Phone number in E.164 format"
          }
        },
        {
          "name": "Delete Trunk",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "https://{{api_key}}:{{api_token}}@{{subdomain}}/v2/accounts/{{account_sid}}/trunks?trunk_sid={{trunk_sid}}",
              "protocol": "https",
              "host": ["{{api_key}}:{{api_token}}@{{subdomain}}"],
              "path": ["v2", "accounts", "{{account_sid}}", "trunks"],
              "query": [
                {
                  "key": "trunk_sid",
                  "value": "{{trunk_sid}}"
                }
              ]
            },
            "description": "⚠️ **PERMANENTLY** deletes the trunk and ALL configurations.\n\nThis cannot be undone. All phone numbers, ACLs, and destination URIs will be removed."
          }
        }
      ]
    }
  ]
}
